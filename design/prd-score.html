<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeSentinel - PRD 质量评分</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            background-color: #000;
            color: #e2e8f0;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .scrollbar-thin::-webkit-scrollbar { width: 4px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 2px; }

        .score-ring {
            transform: rotate(-90deg);
        }
        .score-ring circle {
            transition: stroke-dashoffset 1s ease-out;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // --- Icons ---
        const Icons = {
            Shield: <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10" />,
            FileText: <><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /></>,
            CheckCircle2: <><circle cx="12" cy="12" r="10" /><path d="m9 12 2 2 4-4" /></>,
            AlertTriangle: <><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" /><line x1="12" x2="12" y1="9" y2="13" /><line x1="12" x2="12.01" y1="17" y2="17" /></>,
            XCircle: <><circle cx="12" cy="12" r="10" /><path d="m15 9-6 6" /><path d="m9 9 6 6" /></>,
            ArrowLeft: <><path d="m12 19-7-7 7-7" /><path d="M19 12H5" /></>,
            ChevronRight: <path d="m9 18 6-6-6-6" />,
            ChevronDown: <path d="m6 9 6 6 6-6" />,
            Target: <><circle cx="12" cy="12" r="10" /><circle cx="12" cy="12" r="6" /><circle cx="12" cy="12" r="2" /></>,
            Zap: <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />,
            Lightbulb: <><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5" /><path d="M9 18h6" /><path d="M10 22h4" /></>,
            MessageSquare: <><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" /></>,
            List: <><line x1="8" x2="21" y1="6" y2="6" /><line x1="8" x2="21" y1="12" y2="12" /><line x1="8" x2="21" y1="18" y2="18" /><line x1="3" x2="3.01" y1="6" y2="6" /><line x1="3" x2="3.01" y1="12" y2="12" /><line x1="3" x2="3.01" y1="18" y2="18" /></>,
            Users: <><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" /><circle cx="9" cy="7" r="4" /><path d="M22 21v-2a4 4 0 0 0-3-3.87" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /></>,
            Clock: <><circle cx="12" cy="12" r="10" /><polyline points="12 6 12 12 16 14" /></>,
            TrendingUp: <><polyline points="22 7 13.5 15.5 8.5 10.5 2 17" /><polyline points="16 7 22 7 22 13" /></>,
            Download: <><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><polyline points="7 10 12 15 17 10" /><line x1="12" x2="12" y1="15" y2="3" /></>,
            Share2: <><circle cx="18" cy="5" r="3" /><circle cx="6" cy="12" r="3" /><circle cx="18" cy="19" r="3" /><line x1="8.59" x2="15.42" y1="13.51" y2="17.49" /><line x1="15.41" x2="8.59" y1="6.51" y2="10.49" /></>,
            History: <><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12" /><path d="M3 3v9h9" /><path d="M12 7v5l4 2" /></>,
            Eye: <><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" /><circle cx="12" cy="12" r="3" /></>,
            Edit: <><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" /><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" /></>,
            BookOpen: <><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" /><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" /></>,
            Layers: <><polygon points="12 2 2 7 12 12 22 7 12 2" /><polyline points="2 17 12 22 22 17" /><polyline points="2 12 12 17 22 12" /></>,
            Award: <><circle cx="12" cy="8" r="6" /><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11" /></>,
            Settings: <><circle cx="12" cy="12" r="3" /><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" /></>,
        };

        const Lucide = ({ name, className, size = 16 }) => {
            const icon = Icons[name];
            return icon ? (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icon}
                </svg>
            ) : null;
        };

        // --- Navbar ---
        const Navbar = ({ active }) => (
            <nav className="h-16 flex items-center justify-between px-8 border-b border-white/5 bg-[#0A0A0A]/80 backdrop-blur-md sticky top-0 z-50">
                <div className="flex items-center gap-8">
                    <a href="index.html" className="flex items-center gap-3 group">
                        <div className="w-9 h-9 rounded-xl bg-indigo-600 flex items-center justify-center shadow-lg shadow-indigo-500/20 group-hover:scale-105 transition-transform">
                            <Lucide name="Shield" className="text-white" size={20} />
                        </div>
                        <span className="font-bold text-xl tracking-tight text-white group-hover:text-white/90 transition-colors">
                            CodeSentinel <span className="text-indigo-400 text-xs ml-1 font-normal bg-indigo-500/10 px-1.5 py-0.5 rounded border border-indigo-500/20">Ent</span>
                        </span>
                    </a>
                    <div className="hidden md:flex items-center bg-white/5 rounded-lg p-1 border border-white/5">
                        {[
                            { id: 'overview', label: '仪表盘', href: 'overview.html' },
                            { id: 'workspace', label: '工作台', href: 'workspace.html' },
                            { id: 'mapping', label: '需求映射', href: 'mapping.html' },
                            { id: 'pipeline', label: '流水线', href: 'pipeline.html' },
                            { id: 'configuration', label: '仓库配置', href: 'configuration.html' }
                        ].map((item) => (
                            <a key={item.id} href={item.href} className={`px-5 py-1.5 rounded-md text-sm font-medium transition-all ${active === item.id ? 'bg-white/10 text-white shadow-sm' : 'text-white/40 hover:text-white/80 hover:bg-white/5'}`}>
                                {item.label}
                            </a>
                        ))}
                    </div>
                </div>
                <div className="flex items-center gap-4">
                    <a href="settings.html" className="p-2 rounded-lg hover:bg-white/5 text-white/40 hover:text-white transition-all" title="系统设置">
                        <Lucide name="Settings" size={20} />
                    </a>
                    <div className="flex items-center gap-3 pl-4 border-l border-white/10">
                        <div className="flex flex-col items-end">
                            <span className="text-xs font-medium text-white">张三 (PM)</span>
                            <span className="text-[10px] text-white/40">产品经理</span>
                        </div>
                        <div className="w-8 h-8 rounded-full bg-gradient-to-tr from-indigo-500 to-purple-500 p-[1px]">
                            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=PM" alt="User" className="w-full h-full rounded-full bg-black" />
                        </div>
                    </div>
                </div>
            </nav>
        );

        // --- Mock Data ---
        const PRD_DATA = {
            id: 'PRD-2024-001',
            name: '电商核心交易流程需求规格说明书',
            version: 'v2.1',
            author: '李明 (PM)',
            createTime: '2024-01-10',
            updateTime: '2024-01-18 14:30',
            overallScore: 92,
            dimensions: {
                completeness: { score: 95, weight: 30, label: '完整性', desc: '需求描述完整度' },
                clarity: { score: 88, weight: 25, label: '清晰度', desc: '表述清晰无歧义' },
                testability: { score: 94, weight: 25, label: '可测试性', desc: '需求可验证程度' },
                consistency: { score: 90, weight: 20, label: '一致性', desc: '内部逻辑一致性' }
            },
            totalRequirements: 24,
            parsedRequirements: 24,
            mappedRequirements: 21,
            issues: {
                critical: 0,
                major: 2,
                minor: 5
            }
        };

        const DIMENSION_DETAILS = {
            completeness: {
                passed: [
                    { id: 1, text: '所有功能点均有明确的输入输出定义' },
                    { id: 2, text: '边界条件和异常情况已充分考虑' },
                    { id: 3, text: '用户故事包含完整的验收标准' },
                    { id: 4, text: '非功能性需求（性能、安全）已明确' },
                ],
                failed: [
                    { id: 5, text: '部分需求缺少优先级标注', severity: 'minor' },
                ]
            },
            clarity: {
                passed: [
                    { id: 1, text: '术语定义清晰，无歧义表述' },
                    { id: 2, text: '使用标准化需求模板' },
                ],
                failed: [
                    { id: 3, text: 'REQ-005: "金额汇总"的时间范围定义模糊', severity: 'major' },
                    { id: 4, text: 'REQ-012: 用户等级升级条件描述不够具体', severity: 'minor' },
                ]
            },
            testability: {
                passed: [
                    { id: 1, text: '90%以上需求包含可量化的验收标准' },
                    { id: 2, text: '测试用例可直接从需求推导' },
                    { id: 3, text: '预期结果描述明确' },
                ],
                failed: [
                    { id: 4, text: 'REQ-018: "用户体验良好"为主观描述，难以测试', severity: 'minor' },
                ]
            },
            consistency: {
                passed: [
                    { id: 1, text: '需求间无逻辑冲突' },
                    { id: 2, text: '数据定义在文档内保持一致' },
                ],
                failed: [
                    { id: 3, text: 'REQ-006 与 REQ-015 关于运费计算存在冲突', severity: 'major' },
                    { id: 4, text: '部分术语在不同章节定义不一致', severity: 'minor' },
                ]
            }
        };

        const AI_SUGGESTIONS = [
            {
                id: 1,
                type: 'improvement',
                priority: 'high',
                title: '补充 REQ-005 时间范围定义',
                description: '建议明确"订单金额统计接口"的时间范围参数格式（如 ISO 8601）和默认值',
                impact: '可提升清晰度评分 +3 分',
                autoFix: true
            },
            {
                id: 2,
                type: 'conflict',
                priority: 'high',
                title: '解决 REQ-006 与 REQ-015 冲突',
                description: 'REQ-006 规定 Level 2 用户满 100 减半，REQ-015 规定满 80 减半，需统一阈值',
                impact: '可提升一致性评分 +5 分',
                autoFix: false
            },
            {
                id: 3,
                type: 'enhancement',
                priority: 'medium',
                title: '添加需求优先级标注',
                description: '为 REQ-008、REQ-011、REQ-019 添加优先级（P0/P1/P2）标注',
                impact: '可提升完整性评分 +2 分',
                autoFix: true
            },
            {
                id: 4,
                type: 'improvement',
                priority: 'low',
                title: '量化用户体验指标',
                description: '将 REQ-018 的"用户体验良好"改为具体指标：页面加载 < 2s，操作响应 < 200ms',
                impact: '可提升可测试性评分 +2 分',
                autoFix: true
            }
        ];

        const VERSION_HISTORY = [
            { version: 'v2.1', score: 92, date: '2024-01-18', changes: '修复运费计算逻辑冲突' },
            { version: 'v2.0', score: 85, date: '2024-01-15', changes: '新增用户等级运费规则' },
            { version: 'v1.5', score: 78, date: '2024-01-10', changes: '补充异常处理需求' },
            { version: 'v1.0', score: 65, date: '2024-01-05', changes: '初始版本' },
        ];

        // --- Components ---
        const ScoreRing = ({ score, size = 200, strokeWidth = 12 }) => {
            const radius = (size - strokeWidth) / 2;
            const circumference = 2 * Math.PI * radius;
            const offset = circumference - (score / 100) * circumference;

            const getColor = (s) => {
                if (s >= 90) return '#34d399';
                if (s >= 70) return '#fbbf24';
                return '#f87171';
            };

            return (
                <div className="relative" style={{ width: size, height: size }}>
                    <svg className="score-ring" width={size} height={size}>
                        <circle
                            cx={size / 2}
                            cy={size / 2}
                            r={radius}
                            fill="none"
                            stroke="rgba(255,255,255,0.1)"
                            strokeWidth={strokeWidth}
                        />
                        <circle
                            cx={size / 2}
                            cy={size / 2}
                            r={radius}
                            fill="none"
                            stroke={getColor(score)}
                            strokeWidth={strokeWidth}
                            strokeDasharray={circumference}
                            strokeDashoffset={offset}
                            strokeLinecap="round"
                        />
                    </svg>
                    <div className="absolute inset-0 flex flex-col items-center justify-center">
                        <div className="text-5xl font-bold text-white">{score}</div>
                        <div className="text-sm text-white/40">/ 100</div>
                    </div>
                </div>
            );
        };

        const DimensionCard = ({ dimension, data, isExpanded, onToggle }) => {
            const details = DIMENSION_DETAILS[dimension];
            const getScoreColor = (s) => s >= 90 ? 'text-emerald-400' : s >= 70 ? 'text-amber-400' : 'text-rose-400';
            const getBarColor = (s) => s >= 90 ? 'bg-emerald-500' : s >= 70 ? 'bg-amber-500' : 'bg-rose-500';

            return (
                <div className={`bg-[#0F0F0F] border rounded-xl overflow-hidden transition-all ${isExpanded ? 'border-indigo-500/30' : 'border-white/5 hover:border-white/10'}`}>
                    <div className="p-5 cursor-pointer" onClick={onToggle}>
                        <div className="flex items-center justify-between mb-3">
                            <div className="flex items-center gap-3">
                                <h4 className="text-white font-bold">{data.label}</h4>
                                <span className="text-xs text-white/30">权重 {data.weight}%</span>
                            </div>
                            <div className="flex items-center gap-3">
                                <span className={`text-2xl font-bold ${getScoreColor(data.score)}`}>{data.score}</span>
                                <Lucide name={isExpanded ? 'ChevronDown' : 'ChevronRight'} size={16} className="text-white/30" />
                            </div>
                        </div>
                        <p className="text-sm text-white/50 mb-3">{data.desc}</p>
                        <div className="h-2 bg-white/10 rounded-full overflow-hidden">
                            <div className={`h-full ${getBarColor(data.score)} rounded-full transition-all`} style={{ width: `${data.score}%` }} />
                        </div>
                    </div>

                    {isExpanded && details && (
                        <div className="border-t border-white/5 bg-black/30 p-5 space-y-4">
                            {/* Passed Items */}
                            {details.passed.length > 0 && (
                                <div>
                                    <h5 className="text-xs font-bold text-emerald-400 uppercase tracking-wider mb-3 flex items-center gap-2">
                                        <Lucide name="CheckCircle2" size={12} />
                                        通过项 ({details.passed.length})
                                    </h5>
                                    <div className="space-y-2">
                                        {details.passed.map(item => (
                                            <div key={item.id} className="flex items-start gap-2 text-sm text-white/60">
                                                <Lucide name="CheckCircle2" size={14} className="text-emerald-400 mt-0.5 shrink-0" />
                                                {item.text}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* Failed Items */}
                            {details.failed.length > 0 && (
                                <div>
                                    <h5 className="text-xs font-bold text-rose-400 uppercase tracking-wider mb-3 flex items-center gap-2">
                                        <Lucide name="XCircle" size={12} />
                                        待改进 ({details.failed.length})
                                    </h5>
                                    <div className="space-y-2">
                                        {details.failed.map(item => (
                                            <div key={item.id} className={`flex items-start gap-2 text-sm p-2 rounded-lg ${
                                                item.severity === 'major' ? 'bg-rose-500/10 text-rose-300' : 'bg-amber-500/10 text-amber-300'
                                            }`}>
                                                <Lucide name={item.severity === 'major' ? 'XCircle' : 'AlertTriangle'} size={14} className="mt-0.5 shrink-0" />
                                                <div>
                                                    {item.text}
                                                    <span className={`ml-2 text-[10px] px-1.5 py-0.5 rounded ${
                                                        item.severity === 'major' ? 'bg-rose-500/20 text-rose-400' : 'bg-amber-500/20 text-amber-400'
                                                    }`}>
                                                        {item.severity === 'major' ? '主要' : '次要'}
                                                    </span>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        // --- Main View ---
        const PRDScoreView = () => {
            const [expandedDimension, setExpandedDimension] = useState(null);
            const [activeTab, setActiveTab] = useState('dimensions');

            return (
                <div className="min-h-screen bg-black text-slate-200">
                    <Navbar active="" />
                    <div className="max-w-[1400px] mx-auto px-6 py-8 space-y-6 fade-in">
                        {/* Header */}
                        <div className="flex items-center gap-4 mb-6">
                            <a href="mapping.html" className="flex items-center gap-2 text-white/40 hover:text-white text-sm transition-colors">
                                <Lucide name="ArrowLeft" size={16} /> 返回需求映射
                            </a>
                        </div>

                        {/* Document Info */}
                        <div className="bg-[#0F0F0F] border border-white/5 rounded-2xl p-6">
                            <div className="flex items-start justify-between">
                                <div className="flex items-start gap-6">
                                    <div className="p-4 bg-indigo-500/10 rounded-2xl text-indigo-400">
                                        <Lucide name="FileText" size={32} />
                                    </div>
                                    <div>
                                        <div className="flex items-center gap-3 mb-2">
                                            <h1 className="text-2xl font-bold text-white">{PRD_DATA.name}</h1>
                                            <span className="text-xs bg-white/5 text-white/60 px-2 py-1 rounded border border-white/10">{PRD_DATA.version}</span>
                                        </div>
                                        <div className="flex items-center gap-4 text-sm text-white/40">
                                            <span className="flex items-center gap-1.5">
                                                <Lucide name="Users" size={14} />
                                                {PRD_DATA.author}
                                            </span>
                                            <span className="flex items-center gap-1.5">
                                                <Lucide name="Clock" size={14} />
                                                更新于 {PRD_DATA.updateTime}
                                            </span>
                                            <span className="flex items-center gap-1.5">
                                                <Lucide name="List" size={14} />
                                                {PRD_DATA.totalRequirements} 条需求
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div className="flex items-center gap-3">
                                    <button className="px-4 py-2 bg-white/5 hover:bg-white/10 text-white/60 rounded-lg text-sm font-medium flex items-center gap-2 transition-colors">
                                        <Lucide name="Download" size={14} /> 导出报告
                                    </button>
                                    <button className="px-4 py-2 bg-white/5 hover:bg-white/10 text-white/60 rounded-lg text-sm font-medium flex items-center gap-2 transition-colors">
                                        <Lucide name="Share2" size={14} /> 分享
                                    </button>
                                    <button className="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm font-bold flex items-center gap-2 transition-colors">
                                        <Lucide name="Edit" size={14} /> 编辑文档
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
                            {/* Left: Score & Dimensions */}
                            <div className="lg:col-span-8 space-y-6">
                                {/* Score Overview */}
                                <div className="bg-[#0F0F0F] border border-white/5 rounded-2xl p-8">
                                    <div className="flex items-center justify-between">
                                        <div className="flex items-center gap-8">
                                            <ScoreRing score={PRD_DATA.overallScore} size={180} />
                                            <div className="space-y-4">
                                                <div>
                                                    <div className="text-sm text-white/40 mb-1">综合评分等级</div>
                                                    <div className="flex items-center gap-2">
                                                        <span className="text-2xl font-bold text-emerald-400">优秀</span>
                                                        <Lucide name="Award" size={24} className="text-emerald-400" />
                                                    </div>
                                                </div>
                                                <div className="flex items-center gap-6">
                                                    <div className="text-center">
                                                        <div className="text-2xl font-bold text-white">{PRD_DATA.issues.critical}</div>
                                                        <div className="text-xs text-white/40">严重问题</div>
                                                    </div>
                                                    <div className="text-center">
                                                        <div className="text-2xl font-bold text-amber-400">{PRD_DATA.issues.major}</div>
                                                        <div className="text-xs text-white/40">主要问题</div>
                                                    </div>
                                                    <div className="text-center">
                                                        <div className="text-2xl font-bold text-white/60">{PRD_DATA.issues.minor}</div>
                                                        <div className="text-xs text-white/40">次要问题</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div className="text-right">
                                            <div className="flex items-center gap-2 text-emerald-400 mb-2">
                                                <Lucide name="TrendingUp" size={16} />
                                                <span className="text-sm font-bold">+7 分 vs v2.0</span>
                                            </div>
                                            <div className="text-xs text-white/40">较上版本提升</div>
                                        </div>
                                    </div>
                                </div>

                                {/* Tabs */}
                                <div className="flex items-center gap-1 bg-white/5 p-1 rounded-lg w-fit border border-white/5">
                                    {[
                                        { id: 'dimensions', label: '维度评分', icon: 'Target' },
                                        { id: 'suggestions', label: 'AI 建议', icon: 'Lightbulb' },
                                        { id: 'history', label: '历史版本', icon: 'History' },
                                    ].map(tab => (
                                        <button
                                            key={tab.id}
                                            onClick={() => setActiveTab(tab.id)}
                                            className={`px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2 ${
                                                activeTab === tab.id ? 'bg-white/10 text-white' : 'text-white/40 hover:text-white/80'
                                            }`}
                                        >
                                            <Lucide name={tab.icon} size={14} /> {tab.label}
                                        </button>
                                    ))}
                                </div>

                                {/* Dimensions Tab */}
                                {activeTab === 'dimensions' && (
                                    <div className="space-y-4">
                                        {Object.entries(PRD_DATA.dimensions).map(([key, data]) => (
                                            <DimensionCard
                                                key={key}
                                                dimension={key}
                                                data={data}
                                                isExpanded={expandedDimension === key}
                                                onToggle={() => setExpandedDimension(expandedDimension === key ? null : key)}
                                            />
                                        ))}
                                    </div>
                                )}

                                {/* AI Suggestions Tab */}
                                {activeTab === 'suggestions' && (
                                    <div className="space-y-4">
                                        {AI_SUGGESTIONS.map(suggestion => (
                                            <div key={suggestion.id} className={`bg-[#0F0F0F] border rounded-xl p-5 ${
                                                suggestion.priority === 'high' ? 'border-rose-500/30' :
                                                suggestion.priority === 'medium' ? 'border-amber-500/30' :
                                                'border-white/5'
                                            }`}>
                                                <div className="flex items-start justify-between mb-3">
                                                    <div className="flex items-center gap-3">
                                                        <div className={`p-2 rounded-lg ${
                                                            suggestion.type === 'conflict' ? 'bg-rose-500/10 text-rose-400' :
                                                            suggestion.type === 'improvement' ? 'bg-amber-500/10 text-amber-400' :
                                                            'bg-indigo-500/10 text-indigo-400'
                                                        }`}>
                                                            <Lucide name={
                                                                suggestion.type === 'conflict' ? 'AlertTriangle' :
                                                                suggestion.type === 'improvement' ? 'Lightbulb' : 'Zap'
                                                            } size={18} />
                                                        </div>
                                                        <div>
                                                            <h4 className="text-white font-bold">{suggestion.title}</h4>
                                                            <span className={`text-[10px] px-2 py-0.5 rounded ${
                                                                suggestion.priority === 'high' ? 'bg-rose-500/20 text-rose-400' :
                                                                suggestion.priority === 'medium' ? 'bg-amber-500/20 text-amber-400' :
                                                                'bg-white/10 text-white/40'
                                                            }`}>
                                                                {suggestion.priority === 'high' ? '高优先级' : suggestion.priority === 'medium' ? '中优先级' : '低优先级'}
                                                            </span>
                                                        </div>
                                                    </div>
                                                    {suggestion.autoFix && (
                                                        <button className="px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold flex items-center gap-1.5 transition-colors">
                                                            <Lucide name="Zap" size={12} /> AI 自动修复
                                                        </button>
                                                    )}
                                                </div>
                                                <p className="text-sm text-white/60 mb-3">{suggestion.description}</p>
                                                <div className="flex items-center gap-2 text-xs text-emerald-400">
                                                    <Lucide name="TrendingUp" size={12} />
                                                    {suggestion.impact}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}

                                {/* History Tab */}
                                {activeTab === 'history' && (
                                    <div className="bg-[#0F0F0F] border border-white/5 rounded-2xl overflow-hidden">
                                        <div className="grid grid-cols-12 gap-4 p-4 border-b border-white/5 text-xs font-bold text-white/40 uppercase tracking-wider bg-white/[0.02]">
                                            <div className="col-span-2">版本</div>
                                            <div className="col-span-2">评分</div>
                                            <div className="col-span-3">日期</div>
                                            <div className="col-span-4">变更说明</div>
                                            <div className="col-span-1"></div>
                                        </div>
                                        <div className="divide-y divide-white/5">
                                            {VERSION_HISTORY.map((ver, idx) => (
                                                <div key={ver.version} className={`grid grid-cols-12 gap-4 p-4 items-center ${idx === 0 ? 'bg-indigo-500/5' : 'hover:bg-white/[0.02]'}`}>
                                                    <div className="col-span-2">
                                                        <span className={`text-sm font-bold ${idx === 0 ? 'text-indigo-400' : 'text-white/60'}`}>
                                                            {ver.version}
                                                        </span>
                                                        {idx === 0 && <span className="ml-2 text-[10px] bg-indigo-500/20 text-indigo-400 px-1.5 py-0.5 rounded">当前</span>}
                                                    </div>
                                                    <div className="col-span-2">
                                                        <span className={`text-lg font-bold ${
                                                            ver.score >= 90 ? 'text-emerald-400' :
                                                            ver.score >= 70 ? 'text-amber-400' : 'text-rose-400'
                                                        }`}>{ver.score}</span>
                                                    </div>
                                                    <div className="col-span-3 text-sm text-white/40">{ver.date}</div>
                                                    <div className="col-span-4 text-sm text-white/60">{ver.changes}</div>
                                                    <div className="col-span-1 text-right">
                                                        <button className="p-2 hover:bg-white/10 rounded-lg text-white/40 hover:text-white transition-colors">
                                                            <Lucide name="Eye" size={14} />
                                                        </button>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* Right Sidebar */}
                            <div className="lg:col-span-4 space-y-6">
                                {/* Quick Stats */}
                                <div className="bg-[#0F0F0F] border border-white/5 rounded-2xl p-5">
                                    <h3 className="text-lg font-bold text-white flex items-center gap-2 mb-4">
                                        <Lucide name="Layers" size={20} className="text-indigo-400" />
                                        需求解析统计
                                    </h3>
                                    <div className="space-y-4">
                                        <div className="flex items-center justify-between">
                                            <span className="text-sm text-white/60">需求总数</span>
                                            <span className="text-lg font-bold text-white">{PRD_DATA.totalRequirements}</span>
                                        </div>
                                        <div className="flex items-center justify-between">
                                            <span className="text-sm text-white/60">成功解析</span>
                                            <span className="text-lg font-bold text-emerald-400">{PRD_DATA.parsedRequirements}</span>
                                        </div>
                                        <div className="flex items-center justify-between">
                                            <span className="text-sm text-white/60">已映射代码</span>
                                            <span className="text-lg font-bold text-indigo-400">{PRD_DATA.mappedRequirements}</span>
                                        </div>
                                        <div className="pt-4 border-t border-white/5">
                                            <div className="text-xs text-white/40 mb-2">映射完成度</div>
                                            <div className="flex items-center gap-2">
                                                <div className="flex-1 h-3 bg-white/10 rounded-full overflow-hidden">
                                                    <div
                                                        className="h-full bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"
                                                        style={{ width: `${(PRD_DATA.mappedRequirements / PRD_DATA.totalRequirements) * 100}%` }}
                                                    />
                                                </div>
                                                <span className="text-sm font-bold text-white">
                                                    {Math.round((PRD_DATA.mappedRequirements / PRD_DATA.totalRequirements) * 100)}%
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Score Breakdown */}
                                <div className="bg-[#0F0F0F] border border-white/5 rounded-2xl p-5">
                                    <h3 className="text-lg font-bold text-white flex items-center gap-2 mb-4">
                                        <Lucide name="Target" size={20} className="text-purple-400" />
                                        评分构成
                                    </h3>
                                    <div className="space-y-3">
                                        {Object.entries(PRD_DATA.dimensions).map(([key, data]) => (
                                            <div key={key} className="flex items-center justify-between">
                                                <div className="flex items-center gap-2">
                                                    <span className="text-sm text-white/60">{data.label}</span>
                                                    <span className="text-[10px] text-white/30">({data.weight}%)</span>
                                                </div>
                                                <div className="flex items-center gap-2">
                                                    <div className="w-16 h-1.5 bg-white/10 rounded-full overflow-hidden">
                                                        <div
                                                            className={`h-full rounded-full ${
                                                                data.score >= 90 ? 'bg-emerald-500' :
                                                                data.score >= 70 ? 'bg-amber-500' : 'bg-rose-500'
                                                            }`}
                                                            style={{ width: `${data.score}%` }}
                                                        />
                                                    </div>
                                                    <span className={`text-sm font-bold w-8 text-right ${
                                                        data.score >= 90 ? 'text-emerald-400' :
                                                        data.score >= 70 ? 'text-amber-400' : 'text-rose-400'
                                                    }`}>{data.score}</span>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                {/* Actions */}
                                <div className="bg-[#0F0F0F] border border-white/5 rounded-2xl p-5">
                                    <h3 className="text-lg font-bold text-white flex items-center gap-2 mb-4">
                                        <Lucide name="Zap" size={20} className="text-amber-400" />
                                        快捷操作
                                    </h3>
                                    <div className="space-y-3">
                                        <button className="w-full px-4 py-3 bg-indigo-500/10 hover:bg-indigo-500/20 text-indigo-400 border border-indigo-500/20 rounded-xl text-sm font-bold flex items-center gap-3 transition-colors">
                                            <Lucide name="Zap" size={16} />
                                            一键应用 AI 建议
                                        </button>
                                        <button className="w-full px-4 py-3 bg-white/5 hover:bg-white/10 text-white/60 border border-white/5 rounded-xl text-sm font-medium flex items-center gap-3 transition-colors">
                                            <Lucide name="Eye" size={16} />
                                            查看原始文档
                                        </button>
                                        <button className="w-full px-4 py-3 bg-white/5 hover:bg-white/10 text-white/60 border border-white/5 rounded-xl text-sm font-medium flex items-center gap-3 transition-colors">
                                            <Lucide name="MessageSquare" size={16} />
                                            发起评审讨论
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<PRDScoreView />);
    </script>
</body>

</html>
